<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.5, maximum-scale=5, user-scalable=yes"/>
<link rel="icon" type="image/png" href="favicon.png"/>
<title>Browse All Parts - PC Parts Tracker</title>
<style>
:root{color-scheme:dark;--bg-primary:#0a0e17;--bg-secondary:#0f172a;--bg-card:#1e293b;--accent:#3b82f6;--accent-hover:#2563eb;--text-primary:#f1f5f9;--text-secondary:#cbd5e1;--border:rgba(255,255,255,.08);--card-size:300px}
:root.light-mode{color-scheme:light;--bg-primary:#f8fafc;--bg-secondary:#ffffff;--bg-card:#ffffff;--accent:#3b82f6;--accent-hover:#2563eb;--text-primary:#0f172a;--text-secondary:#64748b;--border:rgba(0,0,0,.1)}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:var(--bg-primary);color:var(--text-primary);line-height:1.6;transition:background-color 0.3s ease,color 0.3s ease}
nav{background:var(--bg-secondary);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:100;backdrop-filter:blur(12px);animation:fadeIn 0.6s ease-out}
.nav-container{max-width:1400px;margin:0 auto;padding:1rem 2rem;display:flex;justify-content:space-between;align-items:center}
.logo{font-size:1.5rem;font-weight:800;background:linear-gradient(135deg,#3b82f6 0%,#8b5cf6 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-decoration:none}
.back-link{color:var(--text-secondary);text-decoration:none;font-weight:500;transition:color .2s}
.back-link:hover{color:var(--text-primary)}
.browse-container{max-width:1400px;margin:2rem auto;padding:0 2rem}
.browse-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;flex-wrap:wrap;gap:1rem}
.browse-header h1{font-size:2.5rem;font-weight:900;animation:fadeInUp 0.8s ease-out}
.search-container{width:100%;max-width:600px;margin-bottom:1.5rem;animation:fadeInUp 0.8s ease-out 0.1s;animation-fill-mode:backwards}
.search-bar{width:100%;padding:1rem 1.5rem;background:var(--bg-card);border:2px solid var(--border);border-radius:12px;color:var(--text-primary);font-size:1rem;transition:all .3s}
.search-bar:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(59,130,246,.1)}
.search-bar::placeholder{color:var(--text-secondary)}
.controls{display:flex;gap:1rem;align-items:center;animation:fadeInUp 0.8s ease-out 0.2s;animation-fill-mode:backwards}
.size-control{display:flex;gap:.5rem;align-items:center;background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:.5rem;position:relative}
.size-button{background:var(--accent);color:white;border:none;width:36px;height:36px;border-radius:8px;cursor:pointer;font-size:1.2rem;display:flex;align-items:center;justify-content:center;transition:all .2s}
.size-button:hover{background:var(--accent-hover);transform:scale(1.1)}
.size-button:active{transform:scale(0.98)}
.size-button:disabled{opacity:.5;cursor:not-allowed;transform:none}
.size-label{color:var(--text-secondary);font-size:.875rem;padding:0 .5rem}
.size-label-mobile{display:none;font-size:1.2rem}
.zoom-indicator{position:absolute;top:100%;left:50%;transform:translateX(-50%) translateY(-10px);margin-top:.5rem;background:var(--bg-card);border:1px solid var(--border);border-radius:8px;padding:.5rem 1rem;font-size:.75rem;color:var(--text-secondary);white-space:nowrap;z-index:10;box-shadow:0 4px 12px rgba(0,0,0,.3);opacity:0;pointer-events:none;transition:opacity 0.3s ease-out,transform 0.3s ease-out}
.zoom-indicator.visible{opacity:1;transform:translateX(-50%) translateY(0)}
.zoom-indicator.maxed{color:#ef4444;font-weight:600}
.zoom-indicator.minned{color:#ef4444;font-weight:600}
.zoom-value{color:var(--text-primary);font-weight:700;margin:0 .25rem}
.filter-tabs{display:flex;gap:.5rem;margin-bottom:2rem;flex-wrap:wrap;animation:fadeInUp 0.8s ease-out 0.3s;animation-fill-mode:backwards}
.filter-tab{padding:.75rem 1.5rem;background:var(--bg-card);border:1px solid var(--border);border-radius:12px;color:var(--text-secondary);cursor:pointer;transition:all .3s;font-weight:500}
.filter-tab:hover{border-color:var(--accent);color:var(--text-primary)}
.filter-tab.active{background:var(--accent);color:white;border-color:var(--accent)}
.filters-section{background:var(--bg-card);border:1px solid var(--border);border-radius:16px;padding:1.5rem;margin-bottom:2rem;animation:fadeInUp 0.8s ease-out 0.4s;animation-fill-mode:backwards}
.filters-toggle{display:none;background:var(--accent);color:white;border:none;padding:1rem;border-radius:12px;font-weight:600;cursor:pointer;transition:all .3s;width:100%;margin-bottom:1rem;font-size:1rem}
.filters-toggle:active{transform:scale(0.98)}
.filters-toggle-icon{margin-left:.5rem;transition:transform .3s}
.filters-toggle.active .filters-toggle-icon{transform:rotate(180deg)}
.filters-content{transition:max-height 0.3s ease-out,opacity 0.3s ease-out;overflow:hidden}
.filters-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem;margin-bottom:1rem}
.filter-group{display:flex;flex-direction:column;gap:.5rem}
.filter-label{font-weight:600;font-size:.875rem;color:var(--text-primary);margin-bottom:.25rem}
.filter-select{background:var(--bg-secondary);border:1px solid var(--border);border-radius:8px;padding:.75rem;color:var(--text-primary);font-size:.875rem;cursor:pointer;transition:all .2s}
.filter-select:hover{border-color:var(--accent)}
.filter-select:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(59,130,246,.1)}
.price-inputs{display:flex;gap:.5rem;align-items:center}
.price-input{background:var(--bg-secondary);border:1px solid var(--border);border-radius:8px;padding:.75rem;color:var(--text-primary);font-size:.875rem;width:100%;transition:all .2s}
.price-input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(59,130,246,.1)}
.price-separator{color:var(--text-secondary)}
.advanced-toggle{background:var(--bg-secondary);border:1px solid var(--border);padding:.75rem 1rem;border-radius:8px;cursor:pointer;transition:all .3s;display:flex;justify-content:space-between;align-items:center;margin-top:1rem}
.advanced-toggle:hover{border-color:var(--accent);background:rgba(59,130,246,.1)}
.advanced-toggle-text{font-weight:600;color:var(--text-primary)}
.advanced-toggle-icon{color:var(--text-secondary);transition:transform .3s}
.advanced-toggle.active .advanced-toggle-icon{transform:rotate(180deg)}
.advanced-options{max-height:0;overflow:hidden;transition:max-height 0.3s ease-out,margin-top 0.3s ease-out}
.advanced-options.active{max-height:800px;margin-top:1rem}
.filter-actions{display:flex;gap:.5rem;margin-top:1rem}
.filter-button{padding:.75rem 1.5rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s}
.filter-button.primary{background:var(--accent);color:white}
.filter-button.primary:hover{background:var(--accent-hover);transform:translateY(-2px)}
.filter-button.secondary{background:var(--bg-secondary);color:var(--text-secondary);border:1px solid var(--border)}
.filter-button.secondary:hover{border-color:var(--accent);color:var(--text-primary)}
.results-count{color:var(--text-secondary);font-size:.875rem;margin-bottom:1rem;animation:fadeInUp 0.8s ease-out 0.5s;animation-fill-mode:backwards}
.parts-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(var(--card-size),1fr));gap:1.5rem;transition:opacity 0.15s ease-out}
.part-card{background:var(--bg-card);border:1px solid var(--border);border-radius:16px;overflow:hidden;transition:all .3s;position:relative;animation:fadeInUp 0.6s ease-out;animation-fill-mode:backwards}
.part-card:hover{transform:translateY(-4px);box-shadow:0 12px 40px rgba(0,0,0,.4);border-color:rgba(59,130,246,.3)}
.part-badge{position:absolute;top:12px;right:12px;background:rgba(239,68,68,.9);color:white;padding:.25rem .75rem;border-radius:999px;font-size:.75rem;font-weight:700;z-index:10}
.part-image{width:100%;aspect-ratio:16/10;background:var(--bg-secondary);object-fit:contain;transition:transform .3s}
.part-card:hover .part-image{transform:scale(1.05)}
.part-content{padding:1.25rem}
.part-title{font-size:1rem;font-weight:600;margin-bottom:.5rem;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.part-meta{display:flex;gap:.75rem;margin-bottom:.75rem;flex-wrap:wrap}
.part-tag{font-size:.75rem;padding:.25rem .5rem;background:rgba(59,130,246,.15);border:1px solid rgba(59,130,246,.25);border-radius:6px;color:#93c5fd}
.part-price{font-size:1.75rem;font-weight:900;color:#10b981;margin-bottom:.75rem}
.part-button{display:block;width:100%;padding:.75rem;background:var(--accent);color:white;text-align:center;text-decoration:none;border-radius:10px;font-weight:600;transition:all .2s}
.part-button:hover{background:var(--accent-hover)}
.loading{text-align:center;padding:4rem 2rem;color:var(--text-secondary)}
.spinner{width:40px;height:40px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 1rem}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}

/* Mobile Responsive */
@media (max-width: 768px) {
.nav-container{padding:1rem}
.browse-container{padding:0 1rem}
.browse-header{flex-direction:column;align-items:flex-start}
.browse-header h1{font-size:1.75rem}
.search-container{max-width:100%}
.controls{width:100%;justify-content:flex-end}
.size-label{display:none}
.size-label-mobile{display:block}
.filter-tabs{gap:.25rem}
.filter-tab{padding:.5rem 1rem;font-size:.875rem}
.filters-section{padding:1rem}
.filters-toggle{display:flex;align-items:center;justify-content:center}
.filters-content{max-height:0;opacity:0;pointer-events:none}
.filters-content.active{max-height:2000px;opacity:1;pointer-events:all}
.filters-grid{grid-template-columns:1fr;gap:.75rem}
.parts-grid{grid-template-columns:repeat(auto-fill,minmax(var(--card-size),1fr));gap:1rem}
.part-image{aspect-ratio:4/5;object-fit:contain}
.filter-actions{flex-direction:column}
.filter-button{width:100%}
}

@media (max-width: 480px) {
.browse-header h1{font-size:1.5rem}
.part-image{aspect-ratio:3/4}
.filters-section{padding:.75rem}
.parts-grid{grid-template-columns:repeat(auto-fill,minmax(max(var(--card-size),150px),1fr))}
}
</style>
</head>
<body>
<nav>
<div class="nav-container">
<a href="index.html" class="logo">PC Parts Tracker</a>
<a href="index.html" class="back-link">‚Üê Back to Home</a>
</div>
</nav>

<div class="browse-container">
<div class="browse-header">
<h1>Browse All Parts</h1>
<div class="search-container">
<input type="text" class="search-bar" id="searchBar" placeholder="üîç Search for parts..." oninput="searchParts()">
</div>
<div class="controls">
<div class="size-control">
<button class="size-button" id="decreaseBtn" onclick="decreaseCardSize()">‚àí</button>
<span class="size-label">Card Size</span>
<span class="size-label-mobile">üîç</span>
<button class="size-button" id="increaseBtn" onclick="increaseCardSize()">+</button>
<div class="zoom-indicator" id="zoomIndicator">
<span class="zoom-value" id="zoomValue">Medium</span>
</div>
</div>
</div>
</div>

<div class="filter-tabs">
<div class="filter-tab active" onclick="filterParts('all')">All Parts</div>
<div class="filter-tab" onclick="filterParts('gpu')">GPUs</div>
<div class="filter-tab" onclick="filterParts('cpu')">CPUs</div>
<div class="filter-tab" onclick="filterParts('motherboard')">Motherboards</div>
<div class="filter-tab" onclick="filterParts('psu')">PSUs</div>
<div class="filter-tab" onclick="filterParts('case')">Cases</div>
<div class="filter-tab" onclick="filterParts('ssd')">Storage</div>
</div>

<div class="filters-section">
<button class="filters-toggle" onclick="toggleFilters()">
üîç Show Filters
<span class="filters-toggle-icon">‚ñº</span>
</button>
<div class="filters-content" id="filtersContent">
<div class="filters-grid">
<div class="filter-group">
<label class="filter-label">Part Type</label>
<select class="filter-select" id="partTypeFilter" onchange="applyFilters()">
<option value="all">All Types</option>
<option value="gpu">Graphics Cards</option>
<option value="cpu">Processors</option>
<option value="motherboard">Motherboards</option>
<option value="psu">Power Supplies</option>
<option value="case">Cases</option>
<option value="ssd">Storage</option>
</select>
</div>

<div class="filter-group">
<label class="filter-label">Site</label>
<select class="filter-select" id="siteFilter" onchange="applyFilters()">
<option value="all">All Sites</option>
<option value="ebay">eBay</option>
<option value="newegg">Newegg</option>
</select>
</div>

<div class="filter-group">
<label class="filter-label">Price Range</label>
<div class="price-inputs">
<input type="number" class="price-input" id="minPrice" placeholder="Min" min="0" onchange="applyFilters()">
<span class="price-separator">‚Äî</span>
<input type="number" class="price-input" id="maxPrice" placeholder="Max" min="0" onchange="applyFilters()">
</div>
</div>

<div class="filter-group">
<label class="filter-label">Brand</label>
<select class="filter-select" id="brandFilter" onchange="applyFilters()">
<option value="all">All Brands</option>
<option value="msi">MSI</option>
<option value="asus">ASUS</option>
<option value="gigabyte">Gigabyte</option>
<option value="evga">EVGA</option>
<option value="corsair">Corsair</option>
<option value="samsung">Samsung</option>
<option value="intel">Intel</option>
<option value="amd">AMD</option>
<option value="nvidia">NVIDIA</option>
<option value="crucial">Crucial</option>
<option value="western digital">Western Digital</option>
<option value="seagate">Seagate</option>
</select>
</div>
</div>

<div class="advanced-toggle" onclick="toggleAdvanced()">
<span class="advanced-toggle-text">‚öôÔ∏è Advanced Options</span>
<span class="advanced-toggle-icon">‚ñº</span>
</div>

<div class="advanced-options" id="advancedOptions">
<div class="filters-grid">
<div class="filter-group">
<label class="filter-label">Condition</label>
<select class="filter-select" id="conditionFilter" onchange="applyFilters()">
<option value="all">All Conditions</option>
<option value="New">New</option>
<option value="Open Box">Open Box</option>
<option value="Used">Used</option>
<option value="Refurbished">Refurbished</option>
</select>
</div>

<div class="filter-group">
<label class="filter-label">Sort By</label>
<select class="filter-select" id="sortFilter" onchange="applyFilters()">
<option value="default">Default</option>
<option value="price-low">Price: Low to High</option>
<option value="price-high">Price: High to Low</option>
<option value="newest">Newest First</option>
</select>
</div>

<div class="filter-group">
<label class="filter-label">Minimum Rating</label>
<select class="filter-select" id="ratingFilter" onchange="applyFilters()">
<option value="all">Any Rating</option>
<option value="4">4+ Stars</option>
<option value="4.5">4.5+ Stars</option>
<option value="5">5 Stars Only</option>
</select>
</div>

<div class="filter-group">
<label class="filter-label">Stock Status</label>
<select class="filter-select" id="stockFilter" onchange="applyFilters()">
<option value="all">All Items</option>
<option value="in-stock">In Stock Only</option>
<option value="deals">On Sale Only</option>
</select>
</div>
</div>
</div>

<div class="filter-actions">
<button class="filter-button primary" onclick="applyFilters()">Apply Filters</button>
<button class="filter-button secondary" onclick="resetFilters()">Reset All</button>
</div>
</div>
</div>

<div class="results-count" id="resultsCount">Showing all parts</div>

<div id="loading" class="loading">
<div class="spinner"></div>
<p>Loading all parts...</p>
</div>

<div id="partsGrid" class="parts-grid" style="display:none"></div>
</div>

<script>
const FALLBACK_IMG = "data:image/svg+xml;charset=utf-8," + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="750"><rect width="100%" height="100%" fill="#0b1220"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-family="Arial" font-size="42" fill="#7aa2ff">No Image</text></svg>');

let allParts = [];
let filteredParts = [];
let currentFilter = 'all';
let cardSize = 300; // Default size in pixels
let hideTimeout = null; // For auto-hiding the zoom indicator

// Load saved theme on page load
function loadTheme() {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'light') {
        document.documentElement.classList.add('light-mode');
    }
}

function searchParts() {
    const searchTerm = document.getElementById('searchBar').value.toLowerCase();
    
    if (searchTerm === '') {
        // If search is empty, just apply regular filters
        applyFilters();
        return;
    }
    
    // Start with all parts or currently filtered parts
    const partsToSearch = currentFilter === 'all' ? allParts : allParts.filter(p => p.partType === currentFilter);
    
    // Search in title, brand, and part type
    filteredParts = partsToSearch.filter(part => {
        const title = (part.title || '').toLowerCase();
        const partType = (part.partType || '').toLowerCase();
        
        return title.includes(searchTerm) || partType.includes(searchTerm);
    });
    
    // Apply other filters on top of search results
    applyFilters();
}

function getSizeName(size) {
    if (size <= 150) return 'Smallest';
    if (size <= 200) return 'Smaller';
    if (size <= 250) return 'Small';
    if (size <= 300) return 'Medium';
    if (size <= 350) return 'Large';
    if (size <= 400) return 'Larger';
    return 'Largest';
}

function upgradeEbayImg(url) {
    if (!url) return FALLBACK_IMG;
    return String(url).trim().replace(/\/s-l\d+\.(jpg|jpeg|png|webp)$/i, '/s-l1600.$1');
}

function calculateSavings() {
    return Math.round(Math.random() * 30) + 10;
}

function toggleAdvanced() {
    const advancedOptions = document.getElementById('advancedOptions');
    const toggle = document.querySelector('.advanced-toggle');
    advancedOptions.classList.toggle('active');
    toggle.classList.toggle('active');
}

function toggleFilters() {
    const filtersContent = document.getElementById('filtersContent');
    const toggle = document.querySelector('.filters-toggle');
    const isActive = filtersContent.classList.toggle('active');
    toggle.classList.toggle('active');
    
    // Update button text
    toggle.innerHTML = isActive 
        ? 'üîç Hide Filters <span class="filters-toggle-icon">‚ñº</span>'
        : 'üîç Show Filters <span class="filters-toggle-icon">‚ñº</span>';
}

async function loadAllParts() {
    try {
        const categories = ['gpu', 'cpu', 'motherboard', 'psu', 'case', 'ssd'];
        allParts = [];
        
        for (const category of categories) {
            try {
                const response = await fetch(`data/${category}.json`, { cache: 'no-store' });
                if (response.ok) {
                    const parts = await response.json();
                    const validParts = parts.filter(p => p.price && p.price > 0);
                    allParts.push(...validParts);
                }
            } catch (error) {
                console.warn(`Failed to load ${category}:`, error);
            }
        }
        
        if (allParts.length === 0) {
            document.getElementById('loading').innerHTML = '<p>No parts found. Check back soon!</p>';
            return;
        }
        
        filteredParts = [...allParts];
        displayParts(filteredParts);
        updateResultsCount();
    } catch (error) {
        console.error('Error loading parts:', error);
        document.getElementById('loading').innerHTML = '<p>Error loading parts. Please try again later.</p>';
    }
}

function applyFilters() {
    const partType = document.getElementById('partTypeFilter').value;
    const site = document.getElementById('siteFilter').value;
    const minPrice = parseFloat(document.getElementById('minPrice').value) || 0;
    const maxPrice = parseFloat(document.getElementById('maxPrice').value) || Infinity;
    const brand = document.getElementById('brandFilter').value;
    const condition = document.getElementById('conditionFilter').value;
    const sort = document.getElementById('sortFilter').value;
    
    // Filter parts
    filteredParts = allParts.filter(part => {
        // Part type filter
        if (partType !== 'all' && part.partType !== partType) return false;
        
        // Site filter
        if (site !== 'all' && part.site.toLowerCase() !== site.toLowerCase()) return false;
        
        // Price filter
        if (part.price < minPrice || part.price > maxPrice) return false;
        
        // Brand filter
        if (brand !== 'all') {
            const title = part.title.toLowerCase();
            if (!title.includes(brand.toLowerCase())) return false;
        }
        
        // Condition filter
        if (condition !== 'all' && part.condition !== condition) return false;
        
        return true;
    });
    
    // Sort parts
    switch(sort) {
        case 'price-low':
            filteredParts.sort((a, b) => a.price - b.price);
            break;
        case 'price-high':
            filteredParts.sort((a, b) => b.price - a.price);
            break;
        case 'newest':
            // Reverse array for newest first
            filteredParts.reverse();
            break;
    }
    
    displayParts(filteredParts);
    updateResultsCount();
}

function resetFilters() {
    document.getElementById('partTypeFilter').value = 'all';
    document.getElementById('siteFilter').value = 'all';
    document.getElementById('minPrice').value = '';
    document.getElementById('maxPrice').value = '';
    document.getElementById('brandFilter').value = 'all';
    document.getElementById('conditionFilter').value = 'all';
    document.getElementById('sortFilter').value = 'default';
    document.getElementById('ratingFilter').value = 'all';
    document.getElementById('stockFilter').value = 'all';
    
    filteredParts = [...allParts];
    displayParts(filteredParts);
    updateResultsCount();
}

function updateResultsCount() {
    const count = filteredParts.length;
    const total = allParts.length;
    const countEl = document.getElementById('resultsCount');
    
    if (count === total) {
        countEl.textContent = `Showing all ${total} parts`;
    } else {
        countEl.textContent = `Showing ${count} of ${total} parts`;
    }
}

function displayParts(parts) {
    const grid = document.getElementById('partsGrid');
    const loading = document.getElementById('loading');
    
    grid.innerHTML = '';
    
    parts.forEach((part, index) => {
        const card = document.createElement('div');
        card.className = 'part-card';
        card.style.animationDelay = `${(index % 12) * 0.05}s`;
        
        const savings = calculateSavings();
        const imgUrl = upgradeEbayImg(part.image_url);
        
        card.innerHTML = `
            <div class="part-badge">-${savings}%</div>
            <img src="${imgUrl}" alt="${part.title}" class="part-image" onerror="this.src='${FALLBACK_IMG}'" loading="lazy">
            <div class="part-content">
                <h3 class="part-title">${part.title}</h3>
                <div class="part-meta">
                    <span class="part-tag">${part.partType}</span>
                    <span class="part-tag">${part.site}</span>
                    <span class="part-tag">${part.condition}</span>
                </div>
                <div class="part-price">$${part.price.toFixed(2)}</div>
                <a href="${part.url}" target="_blank" rel="noopener noreferrer" class="part-button">View Deal ‚Üí</a>
            </div>
        `;
        
        grid.appendChild(card);
    });
    
    loading.style.display = 'none';
    grid.style.display = 'grid';
}

function filterParts(category) {
    currentFilter = category;
    
    // Update active tab
    document.querySelectorAll('.filter-tab').forEach(tab => tab.classList.remove('active'));
    event.target.classList.add('active');
    
    // Update the dropdown
    document.getElementById('partTypeFilter').value = category;
    
    // Apply filters
    applyFilters();
}

function increaseCardSize() {
    cardSize = Math.min(cardSize + 50, 500); // Max 500px
    updateCardSize();
    updateZoomIndicator();
}

function decreaseCardSize() {
    cardSize = Math.max(cardSize - 50, 150); // Min 150px (better for mobile zoom)
    updateCardSize();
    updateZoomIndicator();
}

function updateZoomIndicator() {
    const indicator = document.getElementById('zoomIndicator');
    const decreaseBtn = document.getElementById('decreaseBtn');
    const increaseBtn = document.getElementById('increaseBtn');
    
    // Safety check - make sure elements exist
    if (!indicator || !decreaseBtn || !increaseBtn) {
        console.warn('Zoom indicator elements not found');
        return;
    }
    
    // Get size name
    const sizeName = getSizeName(cardSize);
    
    // Clear any existing timeout
    if (hideTimeout) {
        clearTimeout(hideTimeout);
    }
    
    // Show indicator
    indicator.classList.add('visible');
    
    // Check if at max
    if (cardSize >= 500) {
        indicator.classList.add('maxed');
        indicator.classList.remove('minned');
        indicator.innerHTML = '<span class="zoom-value">' + sizeName + '</span> (Maximum)';
        increaseBtn.disabled = true;
        decreaseBtn.disabled = false;
    }
    // Check if at min
    else if (cardSize <= 150) {
        indicator.classList.add('minned');
        indicator.classList.remove('maxed');
        indicator.innerHTML = '<span class="zoom-value">' + sizeName + '</span> (Minimum)';
        decreaseBtn.disabled = true;
        increaseBtn.disabled = false;
    }
    // Normal range
    else {
        indicator.classList.remove('maxed', 'minned');
        indicator.innerHTML = '<span class="zoom-value">' + sizeName + '</span>';
        decreaseBtn.disabled = false;
        increaseBtn.disabled = false;
    }
    
    // Auto-hide after 2 seconds
    hideTimeout = setTimeout(() => {
        indicator.classList.remove('visible');
    }, 2000);
}

function updateCardSize() {
    // Update CSS variable
    document.documentElement.style.setProperty('--card-size', `${cardSize}px`);
    
    // Force browser to recalculate layout
    const grid = document.getElementById('partsGrid');
    grid.style.gridTemplateColumns = `repeat(auto-fill, minmax(${cardSize}px, 1fr))`;
    
    // Add a subtle animation effect
    grid.style.opacity = '0.7';
    setTimeout(() => {
        grid.style.opacity = '1';
    }, 150);
    
    // Log for debugging
    console.log('Card size updated to:', cardSize);
}

// Load parts on page load
loadTheme();
loadAllParts();
</script>
</body>
</html>
